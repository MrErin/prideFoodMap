---
phase: 02-card-list-bi-directional-sync
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cards.ts
  - src/cards.css
  - index.html
  - src/main.ts
autonomous: true

must_haves:
  truths:
    - 'Location cards display below the map in a scrollable list'
    - 'Each card shows location name, address, and category badge'
    - 'Cards are sorted alphabetically by location name'
    - 'Cards display in mobile-responsive layout (stacked on screens <768px)'
    - "Card list has ARIA attributes for accessibility (role='list', aria-label)"
  artifacts:
    - path: 'src/cards.ts'
      provides: 'Card rendering and DOM manipulation'
      exports: ['createCardElement', 'renderCards']
      min_lines: 50
    - path: 'src/cards.css'
      provides: 'CSS Grid responsive layout and card styling'
      contains: ['display: grid', 'grid-template-columns: repeat(auto-fit', 'max-height: 50vh']
    - path: 'index.html'
      provides: 'Card list container element'
      contains: ['id="card-list"', 'role="list"']
  key_links:
    - from: 'src/main.ts'
      to: 'src/cards.ts'
      via: 'import renderCards and call after initializeMap'
      pattern: "import.*renderCards|renderCards\\(.*\\)"
    - from: 'src/cards.ts'
      to: 'src/map.ts'
      via: 'Import MarkerData interface'
      pattern: 'import.*MarkerData'
---

<objective>
Create the cards.ts module with card rendering, alphabetical sorting, and mobile-responsive CSS Grid layout.

**Purpose:** Users need to view all locations in a card list below the map for quick scanning and accessibility.

**Output:** Working card list UI displaying all location data sorted alphabetically with responsive layout.
</objective>

<execution_context>
@/home/erinmeaker/.claude/get-shit-done/workflows/execute-plan.md
@/home/erinmeaker/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-card-list-bi-directional-sync/02-RESEARCH.md
@src/map.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create cards.ts module with card rendering functions</name>
  <files>src/cards.ts</files>
  <action>
    Create src/cards.ts with the following:

    1. Import MarkerData interface from map.ts:
       ```typescript
       import type { MarkerData } from './map.ts';
       ```

    2. Define LocationCard interface extending MarkerData with markerId:
       ```typescript
       interface LocationCard extends MarkerData {
         markerId: string;
         category: 'Community Fridge' | 'Food Donation';
       }
       ```

    3. Create createCardElement function that:
       - Accepts LocationCard parameter
       - Creates div element with class "card"
       - Sets data-marker-id attribute from markerId
       - Sets role="listitem" and aria-selected="false"
       - Sets tabindex="0" for keyboard focus
       - Creates inner HTML with:
         * h3.card-name for location name
         * p.card-address for full address (street, city, state, zip)
         * .card-badges container with span.badge elements for category
       - Returns HTMLElement

    4. Create renderCards function that:
       - Accepts array of LocationCard and optional container selector (default '#card-list')
       - Sorts cards alphabetically by locationName using localeCompare()
       - Gets or creates container element
       - Clears existing content
       - Iterates sorted cards, appends each createCardElement result
       - Sets aria-label on container if role="list"

    5. Export both createCardElement and renderCards

    DO NOT:
    - Add click handlers (handled in plan 02-03)
    - Add search/filter logic (handled in phase 03)
    - Import StateManager (created in plan 02-02)

  </action>
  <verify>
    File exists at src/cards.ts with exports. TypeScript compiles: npm run build
  </verify>
  <done>
    src/cards.ts exports createCardElement and renderCards. Both functions accept proper types. Cards sort alphabetically by name.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CSS Grid responsive layout for cards</name>
  <files>src/cards.css</files>
  <action>
    Create src/cards.css with the following styles:

    1. .card-list container styles:
       - display: grid
       - grid-template-columns: repeat(auto-fit, minmax(300px, 1fr))
       - gap: 1rem
       - padding: 1rem
       - max-height: 50vh (desktop)
       - overflow-y: auto

    2. .card base styles:
       - border: 2px solid #e0e0e0
       - border-radius: 8px
       - padding: 1rem
       - cursor: pointer
       - transition: border-color 0.2s ease
       - background: white

    3. .card:hover styles:
       - border-color: #9ca3af

    4. .card[aria-selected="true"] styles (for plan 02-03):
       - border-color: #3b82f6
       - border-width: 3px
       - box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2)

    5. .card-name styles:
       - font-size: 1.125rem
       - font-weight: 600
       - margin-bottom: 0.5rem
       - color: #1f2937

    6. .card-address styles:
       - font-size: 0.875rem
       - color: #6b7280
       - margin-bottom: 0.75rem

    7. .card-badges container:
       - display: flex
       - gap: 0.5rem
       - flex-wrap: wrap

    8. .badge styles:
       - padding: 0.25rem 0.75rem
       - border-radius: 9999px
       - font-size: 0.75rem
       - font-weight: 500

    9. .badge-fridge styles:
       - background: #dbeafe
       - color: #1e40af

    10. .badge-donation styles:
       - background: #fce7f3
       - color: #9f1239

    11. @media (max-width: 768px):
       - .card-list: max-height: 40vh, grid-template-columns: 1fr

  </action>
  <verify>
    File exists at src/cards.css. CSS compiles without errors.
  </verify>
  <done>
    src/cards.css provides responsive grid layout with auto-fit columns. Mobile breakpoint stacks cards single-column. Selected state styles defined.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add card list container to HTML and wire up in main.ts</name>
  <files>index.html, src/main.ts</files>
  <action>
    1. Update index.html:
       - After the <div id="map"> element, add:
         ```html
         <div id="card-list" class="card-list" role="list" aria-label="Food locations list"></div>
         ```
       - Import cards.css in <head> after leaflet.css:
         ```html
         <link rel="stylesheet" href="/src/cards.css" />
         ```

    2. Update src/main.ts:
       - Import renderCards from cards.ts
       - After await initializeMap(), get marker data:
         - Import MarkerData type from map.ts
         - Load CSV data using loadCSV (import from map.ts)
       - Create LocationCard[] array with markerId (use placeholder empty string for now - plan 02-03 will add real marker IDs)
       - Assign category based on data source (fridgeData -> 'Community Fridge', donationData -> 'Food Donation')
       - Call renderCards with combined and sorted array

    For markerId placeholder: Use empty string '' since plan 02-03 will implement the real marker ID linking using L.Util.stamp().

    DO NOT:
    - Add click handlers (handled in plan 02-03)
    - Create StateManager (handled in plan 02-02)

  </action>
  <verify>
    index.html has card-list div with ARIA attributes. cards.css is imported. main.ts imports and calls renderCards. Build succeeds: npm run build
  </verify>
  <done>
    Card list container exists in HTML. CSS is imported. main.ts loads CSV data and calls renderCards after map initialization. Cards display in browser.
  </done>
</task>

</tasks>

<verification>
Overall verification that plan is complete:

1. Run npm run build - TypeScript compiles without errors
2. Run npm run dev - Page loads without errors
3. In browser: Cards display below map
4. In browser: Cards show location name, address, and category badge
5. In browser: Cards are sorted alphabetically
6. Resize browser: Cards stack vertically on mobile (<768px)
7. Inspect element: Card list has role="list" and aria-label
8. Inspect element: Each card has role="listitem", aria-selected="false", tabindex="0"
   </verification>

<success_criteria>
Plan is complete when:

1. src/cards.ts exists with createCardElement and renderCards exports
2. src/cards.css exists with Grid responsive layout
3. index.html has card-list container with proper ARIA attributes
4. src/main.ts imports and calls renderCards after initializeMap
5. Cards display in browser below the map
6. Cards are sorted alphabetically by location name
7. Responsive layout works (desktop multi-column, mobile single-column)
8. Each card shows name, address, and category badge
9. All cards have ARIA attributes (role, aria-selected, tabindex)
   </success_criteria>

<output>
After completion, create `.planning/phases/02-card-list-bi-directional-sync/02-01-SUMMARY.md`
</output>
